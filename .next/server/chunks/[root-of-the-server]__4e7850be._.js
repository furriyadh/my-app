module.exports = {

"[project]/.next-internal/server/app/api/google-ads/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/stream [external] (stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}}),
"[externals]/http [external] (http, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}}),
"[externals]/url [external] (url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}}),
"[externals]/punycode [external] (punycode, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("punycode", () => require("punycode"));

module.exports = mod;
}}),
"[externals]/https [external] (https, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}}),
"[externals]/zlib [external] (zlib, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}}),
"[externals]/events [external] (events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}}),
"[externals]/net [external] (net, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("net", () => require("net"));

module.exports = mod;
}}),
"[externals]/tls [external] (tls, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tls", () => require("tls"));

module.exports = mod;
}}),
"[externals]/crypto [external] (crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}}),
"[externals]/buffer [external] (buffer, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}}),
"[externals]/util [external] (util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}}),
"[externals]/path [external] (path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}}),
"[externals]/fs [external] (fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}}),
"[externals]/assert [external] (assert, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("assert", () => require("assert"));

module.exports = mod;
}}),
"[externals]/tty [external] (tty, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tty", () => require("tty"));

module.exports = mod;
}}),
"[externals]/os [external] (os, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}}),
"[externals]/string_decoder [external] (string_decoder, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("string_decoder", () => require("string_decoder"));

module.exports = mod;
}}),
"[externals]/querystring [external] (querystring, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("querystring", () => require("querystring"));

module.exports = mod;
}}),
"[externals]/child_process [external] (child_process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("child_process", () => require("child_process"));

module.exports = mod;
}}),
"[externals]/process [external] (process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("process", () => require("process"));

module.exports = mod;
}}),
"[externals]/http2 [external] (http2, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http2", () => require("http2"));

module.exports = mod;
}}),
"[externals]/dns [external] (dns, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("dns", () => require("dns"));

module.exports = mod;
}}),
"[externals]/node:events [external] (node:events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:events", () => require("node:events"));

module.exports = mod;
}}),
"[externals]/node:process [external] (node:process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:process", () => require("node:process"));

module.exports = mod;
}}),
"[externals]/node:util [external] (node:util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:util", () => require("node:util"));

module.exports = mod;
}}),
"[project]/src/app/api/google-ads/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
// src/app/api/google-ads/route.ts
__turbopack_context__.s({
    "GET": (()=>GET),
    "POST": (()=>POST)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@supabase/supabase-js/dist/module/index.js [app-route] (ecmascript) <locals>");
;
;
// @ts-ignore - Google Ads API doesn't have official TypeScript types
const { GoogleAdsApi } = __turbopack_context__.r("[project]/node_modules/google-ads-api/build/src/index.js [app-route] (ecmascript)");
// ÿ•ŸÜÿ¥ÿßÿ° Supabase client ŸÑŸÑÿÆÿßÿØŸÖ
const supabaseUrl = ("TURBOPACK compile-time value", "https://mkzwqbgcfdzcqmkgzwgy.supabase.co");
const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;
const supabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseServiceKey);
async function POST(request) {
    try {
        console.log('üöÄ Next.js API Route: ÿßÿ≥ÿ™ÿØÿπÿßÿ° Google Ads data ŸÖÿπ Client Library...');
        const body = await request.json();
        const { loginCustomerId, startDate, endDate, dataType, demographicType } = body;
        console.log('üì• Request body:', {
            loginCustomerId,
            startDate,
            endDate,
            dataType,
            demographicType
        });
        // Get environment variables
        const refreshToken = process.env.GOOGLE_REFRESH_TOKEN;
        const clientId = process.env.GOOGLE_CLIENT_ID;
        const clientSecret = process.env.GOOGLE_CLIENT_SECRET;
        const developerId = process.env.GOOGLE_DEVELOPER_TOKEN;
        const mccCustomerId = process.env.MCC_LOGIN_CUSTOMER_ID;
        console.log('üîë Environment check:', {
            hasRefreshToken: !!refreshToken,
            hasClientId: !!clientId,
            hasClientSecret: !!clientSecret,
            hasDeveloperToken: !!developerId,
            hasMccCustomerId: !!mccCustomerId
        });
        if (!refreshToken || !clientId || !clientSecret || !developerId) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                success: false,
                error: 'Missing required environment variables',
                details: {
                    hasRefreshToken: !!refreshToken,
                    hasClientId: !!clientId,
                    hasClientSecret: !!clientSecret,
                    hasDeveloperToken: !!developerId,
                    hasMccCustomerId: !!mccCustomerId
                }
            }, {
                status: 400
            });
        }
        // ÿ•ŸÜÿ¥ÿßÿ° Google Ads API client
        console.log('üîß Creating Google Ads API client...');
        const client = new GoogleAdsApi({
            client_id: clientId,
            client_secret: clientSecret,
            developer_token: developerId
        });
        // Format customer ID (remove dashes)
        const formattedCustomerId = loginCustomerId?.replace(/-/g, '') || '3271710441';
        console.log('üéØ Using customer ID:', formattedCustomerId);
        // ÿ•ŸÜÿ¥ÿßÿ° customer instance
        console.log('üë§ Creating customer instance...');
        const customer = client.Customer({
            customer_id: formattedCustomerId,
            refresh_token: refreshToken,
            login_customer_id: mccCustomerId?.replace(/-/g, '') || undefined
        });
        // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑÿ™Ÿàÿßÿ±ŸäÿÆ
        const endDateFormatted = endDate || new Date().toISOString().split('T')[0];
        const startDateFormatted = startDate || new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
        console.log('üìÖ Date range:', {
            startDateFormatted,
            endDateFormatted
        });
        let query = '';
        let results = [];
        // Handle different data types
        if (dataType === 'demographic_insights') {
            console.log('üìä Fetching demographic insights for:', demographicType);
            if (demographicType === 'age') {
                query = `
          SELECT 
            campaign.id,
            campaign.name,
            ad_group.id,
            ad_group.name,
            ad_group_criterion.age_range.type,
            metrics.impressions,
            metrics.clicks,
            metrics.ctr,
            metrics.conversions,
            metrics.cost_micros,
            segments.date
          FROM age_range_view 
          WHERE campaign.status = 'ENABLED' 
            AND ad_group.status = 'ENABLED'
            AND segments.date >= '${startDateFormatted}'
            AND segments.date <= '${endDateFormatted}'
        `;
            } else if (demographicType === 'gender') {
                query = `
          SELECT 
            campaign.id,
            campaign.name,
            ad_group.id,
            ad_group.name,
            ad_group_criterion.gender.type,
            metrics.impressions,
            metrics.clicks,
            metrics.ctr,
            metrics.conversions,
            metrics.cost_micros,
            segments.date
          FROM gender_view 
          WHERE campaign.status = 'ENABLED' 
            AND ad_group.status = 'ENABLED'
            AND segments.date >= '${startDateFormatted}'
            AND segments.date <= '${endDateFormatted}'
        `;
            } else if (demographicType === 'income') {
                query = `
          SELECT 
            campaign.id,
            campaign.name,
            ad_group.id,
            ad_group.name,
            ad_group_criterion.income_range.type,
            metrics.impressions,
            metrics.clicks,
            metrics.ctr,
            metrics.conversions,
            metrics.cost_micros,
            segments.date
          FROM income_range_view 
          WHERE campaign.status = 'ENABLED' 
            AND ad_group.status = 'ENABLED'
            AND segments.date >= '${startDateFormatted}'
            AND segments.date <= '${endDateFormatted}'
        `;
            }
        } else if (dataType === 'auction_insights') {
            console.log('üéØ Fetching auction insights...');
            query = `
        SELECT 
          campaign.id,
          campaign.name,
          metrics.search_impression_share,
          metrics.search_top_impression_share,
          metrics.search_absolute_top_impression_share,
          metrics.impressions,
          metrics.clicks,
          segments.date
        FROM campaign 
        WHERE campaign.status = 'ENABLED' 
          AND segments.date >= '${startDateFormatted}'
          AND segments.date <= '${endDateFormatted}'
      `;
        } else {
            // Default campaign data
            console.log('üìà Fetching campaign data...');
            query = `
        SELECT 
          campaign.id,
          campaign.name,
          campaign.status,
          metrics.cost_micros,
          metrics.clicks,
          metrics.impressions,
          segments.date
        FROM campaign 
        WHERE campaign.status = 'ENABLED' 
          AND segments.date >= '${startDateFormatted}'
          AND segments.date <= '${endDateFormatted}'
      `;
        }
        console.log('üì° Executing Google Ads query...');
        console.log('üîç Query:', query.trim());
        // ÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑÿßÿ≥ÿ™ÿπŸÑÿßŸÖ
        results = await customer.query(query.trim());
        console.log('‚úÖ Query executed successfully');
        console.log('üìä Results count:', results.length);
        // Transform data based on type
        let transformedData = [];
        if (dataType === 'demographic_insights') {
            // Group by demographic value
            const demographicGroups = {};
            results.forEach((row)=>{
                let demographicValue = '';
                if (demographicType === 'age') {
                    demographicValue = row.ad_group_criterion?.age_range?.type || 'Unknown';
                    // Clean up age range names
                    demographicValue = demographicValue.replace('AGE_RANGE_', '').replace('_', '-');
                } else if (demographicType === 'gender') {
                    demographicValue = row.ad_group_criterion?.gender?.type || 'Unknown';
                    // Clean up gender names
                    demographicValue = demographicValue.replace('GENDER_', '');
                } else if (demographicType === 'income') {
                    demographicValue = row.ad_group_criterion?.income_range?.type || 'Unknown';
                    // Clean up income names
                    demographicValue = demographicValue.replace('HOUSEHOLD_INCOME_', '').replace('_', ' ');
                }
                if (!demographicGroups[demographicValue]) {
                    demographicGroups[demographicValue] = {
                        demographic_value: demographicValue,
                        impressions: 0,
                        clicks: 0,
                        conversions: 0,
                        cost_micros: 0
                    };
                }
                const metrics = row.metrics || {};
                demographicGroups[demographicValue].impressions += parseInt(metrics.impressions) || 0;
                demographicGroups[demographicValue].clicks += parseInt(metrics.clicks) || 0;
                demographicGroups[demographicValue].conversions += parseInt(metrics.conversions) || 0;
                demographicGroups[demographicValue].cost_micros += parseInt(metrics.cost_micros) || 0;
            });
            // Calculate averages and convert to final format
            transformedData = Object.values(demographicGroups).map((group)=>({
                    demographic_value: group.demographic_value,
                    impressions: group.impressions,
                    clicks: group.clicks,
                    ctr: group.impressions > 0 ? group.clicks / group.impressions * 100 : 0,
                    conversions: group.conversions,
                    cost: group.cost_micros / 1000000,
                    conversion_rate: group.clicks > 0 ? group.conversions / group.clicks * 100 : 0,
                    cost_per_conversion: group.conversions > 0 ? group.cost_micros / 1000000 / group.conversions : 0
                }));
        } else if (dataType === 'auction_insights') {
            // Calculate auction insights summary
            let totalSearchImpressionShare = 0;
            let totalTopImpressionShare = 0;
            let totalAbsoluteTopImpressionShare = 0;
            let totalPosition = 0;
            let validRows = 0;
            results.forEach((row)=>{
                const metrics = row.metrics || {};
                if (metrics.impressions && parseInt(metrics.impressions) > 0) {
                    totalSearchImpressionShare += parseFloat(metrics.search_impression_share) || 0;
                    totalTopImpressionShare += parseFloat(metrics.search_top_impression_share) || 0;
                    totalAbsoluteTopImpressionShare += parseFloat(metrics.search_absolute_top_impression_share) || 0;
                    validRows++;
                }
            });
            transformedData = {
                impression_share: validRows > 0 ? totalSearchImpressionShare / validRows : 0,
                avg_position: 2.3,
                overlap_rate: validRows > 0 ? totalTopImpressionShare / validRows : 0,
                top_of_page_rate: validRows > 0 ? totalAbsoluteTopImpressionShare / validRows : 0,
                competitors: [],
                time_series: results.map((row)=>({
                        date: row.segments?.date || '',
                        impression_share: parseFloat(row.metrics?.search_impression_share) || 0,
                        avg_position: 2.3,
                        overlap_rate: parseFloat(row.metrics?.search_top_impression_share) || 0
                    }))
            };
        } else {
            // Default campaign transformation
            transformedData = results.map((row, index)=>{
                const campaign = row.campaign || {};
                const metrics = row.metrics || {};
                const segments = row.segments || {};
                return {
                    id: campaign.id?.toString() || `campaign_${index}`,
                    name: campaign.name || 'Unknown Campaign',
                    status: campaign.status || 'UNKNOWN',
                    cost: metrics.cost_micros ? (parseInt(metrics.cost_micros) / 1000000).toFixed(2) : '0.00',
                    clicks: parseInt(metrics.clicks) || 0,
                    impressions: parseInt(metrics.impressions) || 0,
                    date: segments.date || 'unknown',
                    type: 'campaign',
                    platform: 'google_ads',
                    currency: 'USD'
                };
            });
        }
        console.log('üîÑ Data transformed:', transformedData);
        // Handle campaign summary only for default campaign data
        let finalData = transformedData;
        if (dataType !== 'demographic_insights' && dataType !== 'auction_insights') {
            // ÿ™ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑÿ≠ŸÖŸÑÿ© (ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ÿπÿØÿ© ÿ£ŸäÿßŸÖ)
            const campaignSummary = transformedData.reduce((acc, row)=>{
                const campaignId = row.id;
                if (!acc[campaignId]) {
                    acc[campaignId] = {
                        id: row.id,
                        name: row.name,
                        status: row.status,
                        cost: 0,
                        clicks: 0,
                        impressions: 0,
                        dates: [],
                        type: row.type,
                        platform: row.platform,
                        currency: row.currency
                    };
                }
                acc[campaignId].cost += parseFloat(row.cost);
                acc[campaignId].clicks += parseInt(row.clicks);
                acc[campaignId].impressions += parseInt(row.impressions);
                acc[campaignId].dates.push(row.date);
                return acc;
            }, {});
            finalData = Object.values(campaignSummary).map((campaign)=>({
                    ...campaign,
                    cost: campaign.cost.toFixed(2),
                    // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ©
                    ctr: campaign.impressions > 0 ? (campaign.clicks / campaign.impressions * 100).toFixed(2) : '0.00',
                    cpc: campaign.clicks > 0 ? (campaign.cost / campaign.clicks).toFixed(2) : '0.00',
                    dateRange: `${startDateFormatted} to ${endDateFormatted}`
                }));
        }
        console.log('üîÑ Data transformed and summarized:', finalData);
        // Save data to Supabase Database with proper structure
        try {
            console.log('üíæ Saving data to Supabase...');
            // ÿ•ŸÜÿ¥ÿßÿ° record Ÿàÿßÿ≠ÿØ ŸÑŸÑÿ≠ŸÅÿ∏
            const supabaseRecord = {
                customer_id: formattedCustomerId,
                campaigns_data: finalData,
                total_campaigns: finalData.length,
                total_cost: finalData.reduce((sum, campaign)=>sum + parseFloat(campaign.cost), 0).toFixed(2),
                total_clicks: finalData.reduce((sum, campaign)=>sum + campaign.clicks, 0),
                total_impressions: finalData.reduce((sum, campaign)=>sum + campaign.impressions, 0),
                date_range_start: startDateFormatted,
                date_range_end: endDateFormatted,
                fetched_at: new Date().toISOString(),
                data_type: dataType || 'campaigns'
            };
            const { error: saveError } = await supabase.from('google_ads_campaigns').upsert(supabaseRecord, {
                onConflict: 'customer_id,date_range_start,date_range_end'
            });
            if (saveError) {
                console.error('‚ùå Supabase save error:', saveError);
            } else {
                console.log('‚úÖ Data saved to Supabase successfully');
            }
        } catch (saveError) {
            console.error('‚ùå Supabase save failed:', saveError);
        // Continue even if save fails
        }
        // ÿ•ÿ±ÿ¨ÿßÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿßŸÑÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑŸÖÿ™ŸàŸÇÿπ ŸÖŸÜ Frontend
        const response = {
            success: true,
            data: finalData,
            dataType: dataType,
            demographicType: demographicType,
            summary: dataType === 'demographic_insights' || dataType === 'auction_insights' ? null : {
                totalCampaigns: Array.isArray(finalData) ? finalData.length : 0,
                totalCost: Array.isArray(finalData) ? finalData.reduce((sum, campaign)=>sum + parseFloat(campaign.cost), 0).toFixed(2) : '0.00',
                totalClicks: Array.isArray(finalData) ? finalData.reduce((sum, campaign)=>sum + campaign.clicks, 0) : 0,
                totalImpressions: Array.isArray(finalData) ? finalData.reduce((sum, campaign)=>sum + campaign.impressions, 0) : 0,
                dateRange: `${startDateFormatted} to ${endDateFormatted}`
            },
            metadata: {
                query: query.trim(),
                customerId: formattedCustomerId,
                fetchedAt: new Date().toISOString(),
                source: 'google_ads_api'
            }
        };
        console.log('üì§ Sending response:', response);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(response);
    } catch (error) {
        console.error('üí• ÿÆÿ∑ÿ£ ŸÅŸä Google Ads API:', error);
        // ÿ™ŸÅÿµŸäŸÑ ÿ£ŸÉÿ´ÿ± ŸÑŸÑÿ£ÿÆÿ∑ÿßÿ°
        let errorMessage = error.message || 'Unknown error';
        let errorDetails = {};
        if (error.details) {
            errorDetails = error.details;
        }
        if (error.failure) {
            errorDetails = {
                ...errorDetails,
                failure: error.failure
            };
        }
        if (error.errors) {
            errorDetails = {
                ...errorDetails,
                errors: error.errors
            };
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: false,
            error: 'Google Ads API error',
            message: errorMessage,
            details: errorDetails,
            timestamp: new Date().toISOString()
        }, {
            status: 500
        });
    }
}
async function GET(request) {
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
        message: 'Google Ads API Route is working with Client Library. Use POST method to fetch data.',
        timestamp: new Date().toISOString(),
        library: 'google-ads-api',
        status: 'ready',
        endpoints: {
            campaigns: 'POST /api/google-ads with dataType: campaigns',
            demographics: 'POST /api/google-ads with dataType: demographic_insights & demographicType: age|gender|income',
            auction_insights: 'POST /api/google-ads with dataType: auction_insights'
        }
    });
}
}}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__4e7850be._.js.map
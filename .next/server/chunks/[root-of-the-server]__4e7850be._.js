module.exports = {

"[project]/.next-internal/server/app/api/google-ads/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/stream [external] (stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}}),
"[externals]/http [external] (http, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}}),
"[externals]/url [external] (url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}}),
"[externals]/punycode [external] (punycode, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("punycode", () => require("punycode"));

module.exports = mod;
}}),
"[externals]/https [external] (https, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}}),
"[externals]/zlib [external] (zlib, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}}),
"[externals]/events [external] (events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}}),
"[externals]/net [external] (net, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("net", () => require("net"));

module.exports = mod;
}}),
"[externals]/tls [external] (tls, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tls", () => require("tls"));

module.exports = mod;
}}),
"[externals]/crypto [external] (crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}}),
"[externals]/buffer [external] (buffer, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}}),
"[externals]/util [external] (util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}}),
"[externals]/path [external] (path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}}),
"[externals]/fs [external] (fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}}),
"[externals]/assert [external] (assert, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("assert", () => require("assert"));

module.exports = mod;
}}),
"[externals]/tty [external] (tty, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tty", () => require("tty"));

module.exports = mod;
}}),
"[externals]/os [external] (os, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}}),
"[externals]/string_decoder [external] (string_decoder, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("string_decoder", () => require("string_decoder"));

module.exports = mod;
}}),
"[externals]/querystring [external] (querystring, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("querystring", () => require("querystring"));

module.exports = mod;
}}),
"[externals]/child_process [external] (child_process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("child_process", () => require("child_process"));

module.exports = mod;
}}),
"[externals]/process [external] (process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("process", () => require("process"));

module.exports = mod;
}}),
"[externals]/http2 [external] (http2, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http2", () => require("http2"));

module.exports = mod;
}}),
"[externals]/dns [external] (dns, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("dns", () => require("dns"));

module.exports = mod;
}}),
"[externals]/node:events [external] (node:events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:events", () => require("node:events"));

module.exports = mod;
}}),
"[externals]/node:process [external] (node:process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:process", () => require("node:process"));

module.exports = mod;
}}),
"[externals]/node:util [external] (node:util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:util", () => require("node:util"));

module.exports = mod;
}}),
"[project]/src/app/api/google-ads/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
// src/app/api/google-ads/route.ts
__turbopack_context__.s({
    "GET": (()=>GET),
    "POST": (()=>POST),
    "PUT": (()=>PUT)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@supabase/supabase-js/dist/module/index.js [app-route] (ecmascript) <locals>");
;
;
// @ts-ignore - Google Ads API doesn't have official TypeScript types
const { GoogleAdsApi } = __turbopack_context__.r("[project]/node_modules/google-ads-api/build/src/index.js [app-route] (ecmascript)");
// ÿ•ŸÜÿ¥ÿßÿ° Supabase client ŸÑŸÑÿÆÿßÿØŸÖ
const supabaseUrl = ("TURBOPACK compile-time value", "https://mkzwqbgcfdzcqmkgzwgy.supabase.co");
const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;
const supabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(supabaseUrl, supabaseServiceKey);
// Helper function to generate comprehensive demo data as fallback
const generateComprehensiveDemoData = ()=>{
    const campaigns = [
        {
            id: 'camp_001',
            name: 'Performance Max - All Products',
            status: 'ENABLED',
            type: 'Performance Max',
            subType: 'All Products',
            budget: 8000,
            spend: 6567.20,
            impressions: 234560,
            clicks: 4456,
            conversions: 234,
            ctr: 1.90,
            avgCpc: 14.735,
            conversionRate: 5.25,
            costPerConversion: 28.07,
            qualityScore: 8.5,
            impressionShare: 85.2,
            targetLocation: 'Egypt, Saudi Arabia',
            bidStrategy: 'Maximize Conversions',
            startDate: '2024-01-01',
            endDate: '2024-12-31',
            devicePerformance: {
                desktop: {
                    impressions: 70368,
                    clicks: 1337,
                    cost: 1970.16
                },
                mobile: {
                    impressions: 140736,
                    clicks: 2669,
                    cost: 3940.32
                },
                tablet: {
                    impressions: 23456,
                    clicks: 450,
                    cost: 656.72
                }
            },
            audienceData: {
                ageGroups: {
                    '18-24': 15,
                    '25-34': 35,
                    '35-44': 30,
                    '45-54': 15,
                    '55+': 5
                },
                genders: {
                    male: 60,
                    female: 38,
                    unknown: 2
                },
                interests: [
                    'Technology',
                    'Shopping',
                    'Electronics'
                ]
            },
            geoPerformance: {
                'Egypt': {
                    impressions: 140736,
                    clicks: 2669,
                    cost: 3940.32
                },
                'Saudi Arabia': {
                    impressions: 93824,
                    clicks: 1787,
                    cost: 2626.88
                }
            }
        },
        {
            id: 'camp_002',
            name: 'Shopping - Home & Garden Products',
            status: 'ENABLED',
            type: 'Shopping',
            subType: 'Smart Shopping',
            budget: 6000,
            spend: 4567.90,
            impressions: 156780,
            clicks: 2876,
            conversions: 156,
            ctr: 1.83,
            avgCpc: 15.885,
            conversionRate: 5.42,
            costPerConversion: 29.28,
            qualityScore: 7.8,
            impressionShare: 78.5,
            targetLocation: 'Egypt, UAE',
            bidStrategy: 'Target ROAS',
            startDate: '2024-02-01',
            endDate: '2024-12-31',
            devicePerformance: {
                desktop: {
                    impressions: 62712,
                    clicks: 1150,
                    cost: 1827.16
                },
                mobile: {
                    impressions: 78390,
                    clicks: 1438,
                    cost: 2283.95
                },
                tablet: {
                    impressions: 15678,
                    clicks: 288,
                    cost: 456.79
                }
            },
            audienceData: {
                ageGroups: {
                    '25-34': 25,
                    '35-44': 40,
                    '45-54': 25,
                    '55+': 10
                },
                genders: {
                    male: 35,
                    female: 63,
                    unknown: 2
                },
                interests: [
                    'Home & Garden',
                    'Lifestyle',
                    'Interior Design'
                ]
            },
            geoPerformance: {
                'Egypt': {
                    impressions: 94068,
                    clicks: 1726,
                    cost: 2740.74
                },
                'UAE': {
                    impressions: 62712,
                    clicks: 1150,
                    cost: 1827.16
                }
            }
        },
        {
            id: 'camp_003',
            name: 'Search - Electronics & Gadgets',
            status: 'ENABLED',
            type: 'Search',
            subType: 'Standard',
            budget: 5000,
            spend: 3247.50,
            impressions: 125430,
            clicks: 2156,
            conversions: 89,
            ctr: 1.72,
            avgCpc: 15.065,
            conversionRate: 4.13,
            costPerConversion: 36.49,
            qualityScore: 9.2,
            impressionShare: 92.1,
            targetLocation: 'Egypt',
            bidStrategy: 'Enhanced CPC',
            startDate: '2024-01-15',
            endDate: '2024-12-31',
            devicePerformance: {
                desktop: {
                    impressions: 37629,
                    clicks: 647,
                    cost: 974.25
                },
                mobile: {
                    impressions: 75258,
                    clicks: 1293,
                    cost: 1948.50
                },
                tablet: {
                    impressions: 12543,
                    clicks: 216,
                    cost: 324.75
                }
            },
            audienceData: {
                ageGroups: {
                    '18-24': 30,
                    '25-34': 35,
                    '35-44': 25,
                    '45-54': 8,
                    '55+': 2
                },
                genders: {
                    male: 70,
                    female: 28,
                    unknown: 2
                },
                interests: [
                    'Electronics',
                    'Technology',
                    'Gaming'
                ]
            },
            geoPerformance: {
                'Egypt': {
                    impressions: 125430,
                    clicks: 2156,
                    cost: 3247.50
                }
            }
        }
    ];
    // Calculate comprehensive summary
    const totalSpend = campaigns.reduce((sum, c)=>sum + c.spend, 0);
    const totalClicks = campaigns.reduce((sum, c)=>sum + c.clicks, 0);
    const totalImpressions = campaigns.reduce((sum, c)=>sum + c.impressions, 0);
    const totalConversions = campaigns.reduce((sum, c)=>sum + c.conversions, 0);
    const summary = {
        totalSpend,
        totalClicks,
        totalImpressions,
        totalConversions,
        avgCpc: totalSpend / totalClicks,
        avgCtr: totalClicks / totalImpressions * 100,
        conversionRate: totalConversions / totalClicks * 100,
        impressionShare: campaigns.reduce((sum, c)=>sum + c.impressionShare, 0) / campaigns.length,
        qualityScore: campaigns.reduce((sum, c)=>sum + c.qualityScore, 0) / campaigns.length,
        campaignTypes: {
            'Performance Max': 1,
            'Shopping': 1,
            'Search': 1
        },
        statusBreakdown: {
            enabled: campaigns.filter((c)=>c.status === 'ENABLED').length,
            paused: campaigns.filter((c)=>c.status === 'PAUSED').length,
            removed: campaigns.filter((c)=>c.status === 'REMOVED').length
        },
        performanceTrends: {
            impressions: {
                current: totalImpressions,
                previous: totalImpressions * 0.85,
                change: 15
            },
            clicks: {
                current: totalClicks,
                previous: totalClicks * 0.92,
                change: 8
            },
            cost: {
                current: totalSpend,
                previous: totalSpend * 1.05,
                change: -5
            },
            conversions: {
                current: totalConversions,
                previous: totalConversions * 0.88,
                change: 12
            }
        },
        topPerformingCampaigns: campaigns.sort((a, b)=>b.conversionRate - a.conversionRate).slice(0, 3),
        recommendations: [
            {
                type: 'budget',
                title: 'Increase Budget for Top Performers',
                description: 'Performance Max campaign shows strong conversion rates. Consider increasing budget by 20%.',
                impact: 'high',
                campaignId: 'camp_001'
            },
            {
                type: 'keyword',
                title: 'Expand Keyword Targeting',
                description: 'Electronics campaign has high impression share. Add related keywords to capture more traffic.',
                impact: 'medium',
                campaignId: 'camp_003'
            }
        ]
    };
    return {
        campaigns,
        summary
    };
};
async function GET(request) {
    try {
        const { searchParams } = new URL(request.url);
        const dataType = searchParams.get('dataType') || 'campaigns';
        const campaignType = searchParams.get('campaignType');
        const status = searchParams.get('status');
        const search = searchParams.get('search');
        console.log('üîç GET Request params:', {
            dataType,
            campaignType,
            status,
            search
        });
        // Try to fetch real data from Google Ads API
        try {
            const realData = await fetchGoogleAdsData();
            if (realData.success && realData.data) {
                console.log('‚úÖ Real Google Ads data fetched successfully');
                return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(realData);
            }
        } catch (error) {
            console.log('‚ö†Ô∏è Google Ads API failed, using demo data');
        }
        // Fallback to comprehensive demo data
        console.log('üîÑ Using comprehensive demo data as fallback');
        const demoData = generateComprehensiveDemoData();
        // Apply filters if provided
        let filteredCampaigns = demoData.campaigns;
        if (campaignType && campaignType !== 'all') {
            filteredCampaigns = filteredCampaigns.filter((c)=>c.type.toLowerCase().includes(campaignType.toLowerCase()));
        }
        if (status && status !== 'all') {
            filteredCampaigns = filteredCampaigns.filter((c)=>c.status.toLowerCase() === status.toLowerCase());
        }
        if (search) {
            filteredCampaigns = filteredCampaigns.filter((c)=>c.name.toLowerCase().includes(search.toLowerCase()));
        }
        // Use original summary (comprehensive) regardless of filters
        const response = {
            success: true,
            data: {
                campaigns: filteredCampaigns,
                summary: demoData.summary,
                totalCount: demoData.campaigns.length,
                filteredCount: filteredCampaigns.length
            },
            note: 'Using comprehensive demo data - configure Google Ads API for real data',
            isDemo: true
        };
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(response);
    } catch (error) {
        console.error('‚ùå API Error:', error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: false,
            error: 'Failed to fetch campaign data',
            data: {
                campaigns: [],
                summary: {
                    totalSpend: 0,
                    totalClicks: 0,
                    totalImpressions: 0,
                    totalConversions: 0,
                    avgCpc: 0,
                    avgCtr: 0,
                    conversionRate: 0,
                    impressionShare: 0,
                    qualityScore: 0,
                    campaignTypes: {},
                    statusBreakdown: {
                        enabled: 0,
                        paused: 0,
                        removed: 0
                    },
                    performanceTrends: {
                        impressions: {
                            current: 0,
                            previous: 0,
                            change: 0
                        },
                        clicks: {
                            current: 0,
                            previous: 0,
                            change: 0
                        },
                        cost: {
                            current: 0,
                            previous: 0,
                            change: 0
                        },
                        conversions: {
                            current: 0,
                            previous: 0,
                            change: 0
                        }
                    },
                    topPerformingCampaigns: [],
                    recommendations: []
                }
            }
        }, {
            status: 500
        });
    }
}
async function POST(request) {
    try {
        console.log('üöÄ POST Request: Fetching Google Ads data...');
        const body = await request.json();
        const { loginCustomerId, startDate, endDate, dataType } = body;
        console.log('üì• Request body:', {
            loginCustomerId,
            startDate,
            endDate,
            dataType
        });
        // Try to fetch real data
        const realData = await fetchGoogleAdsDataWithParams(loginCustomerId, startDate, endDate, dataType);
        if (realData.success) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(realData);
        } else {
            // Fallback to demo data
            console.log('üîÑ Using demo data as fallback');
            const demoData = generateComprehensiveDemoData();
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                success: true,
                data: demoData,
                message: 'Demo data (Google Ads API unavailable)',
                isDemo: true
            });
        }
    } catch (error) {
        console.error('‚ùå POST request error:', error);
        // Always return demo data on error
        const demoData = generateComprehensiveDemoData();
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: true,
            data: demoData,
            message: 'Demo data (API error)',
            isDemo: true,
            error: error.message
        });
    }
}
async function PUT(request) {
    try {
        const body = await request.json();
        const { campaignId, action } = body;
        console.log(`üîß Campaign action: ${action} for campaign ${campaignId}`);
        // In demo mode, just return success
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: true,
            message: `Campaign ${campaignId} ${action}d successfully (demo mode)`,
            isDemo: true
        });
    } catch (error) {
        console.error('‚ùå PUT request error:', error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: false,
            error: 'Campaign action failed',
            message: error.message
        }, {
            status: 500
        });
    }
}
// Helper function to fetch real Google Ads data
async function fetchGoogleAdsData() {
    try {
        // Get environment variables
        const refreshToken = process.env.GOOGLE_REFRESH_TOKEN;
        const clientId = process.env.GOOGLE_CLIENT_ID;
        const clientSecret = process.env.GOOGLE_CLIENT_SECRET;
        const developerId = process.env.GOOGLE_DEVELOPER_TOKEN;
        const mccCustomerId = process.env.MCC_LOGIN_CUSTOMER_ID;
        if (!refreshToken || !clientId || !clientSecret || !developerId) {
            throw new Error('Missing required environment variables');
        }
        // Create Google Ads API client
        const client = new GoogleAdsApi({
            client_id: clientId,
            client_secret: clientSecret,
            developer_token: developerId
        });
        // Use default customer ID
        const formattedCustomerId = '3271710441';
        const customer = client.Customer({
            customer_id: formattedCustomerId,
            refresh_token: refreshToken,
            login_customer_id: mccCustomerId?.replace(/-/g, '') || undefined
        });
        // Date range (last 7 days)
        const endDate = new Date().toISOString().split('T')[0];
        const startDate = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
        // Enhanced Google Ads API query
        const query = `
      SELECT 
        campaign.id,
        campaign.name,
        campaign.status,
        campaign.advertising_channel_type,
        metrics.cost_micros,
        metrics.clicks,
        metrics.impressions,
        metrics.conversions,
        metrics.ctr,
        metrics.average_cpc,
        segments.date
      FROM campaign 
      WHERE campaign.status IN ('ENABLED', 'PAUSED')
        AND segments.date >= '${startDate}'
        AND segments.date <= '${endDate}'
    `;
        console.log('üì° Executing Google Ads query...');
        const results = await customer.query(query.trim());
        console.log('‚úÖ Query executed successfully, results:', results.length);
        // Transform real data to match our interface
        const campaignMap = new Map();
        results.forEach((row)=>{
            const campaign = row.campaign || {};
            const metrics = row.metrics || {};
            const campaignId = campaign.id?.toString() || 'unknown';
            if (!campaignMap.has(campaignId)) {
                campaignMap.set(campaignId, {
                    id: campaignId,
                    name: campaign.name || 'Unknown Campaign',
                    status: campaign.status || 'UNKNOWN',
                    type: campaign.advertising_channel_type || 'Unknown',
                    subType: 'Standard',
                    budget: 5000,
                    spend: 0,
                    impressions: 0,
                    clicks: 0,
                    conversions: 0,
                    ctr: 0,
                    avgCpc: 0,
                    conversionRate: 0,
                    costPerConversion: 0,
                    qualityScore: 8.0,
                    impressionShare: 85,
                    targetLocation: 'Egypt',
                    bidStrategy: 'Enhanced CPC',
                    startDate: '2024-01-01',
                    endDate: '2024-12-31',
                    devicePerformance: {
                        desktop: {
                            impressions: 0,
                            clicks: 0,
                            cost: 0
                        },
                        mobile: {
                            impressions: 0,
                            clicks: 0,
                            cost: 0
                        },
                        tablet: {
                            impressions: 0,
                            clicks: 0,
                            cost: 0
                        }
                    },
                    audienceData: {
                        ageGroups: {
                            '25-34': 50,
                            '35-44': 30,
                            '18-24': 20
                        },
                        genders: {
                            male: 50,
                            female: 48,
                            unknown: 2
                        },
                        interests: [
                            'General'
                        ]
                    },
                    geoPerformance: {
                        'Egypt': {
                            impressions: 0,
                            clicks: 0,
                            cost: 0
                        }
                    }
                });
            }
            const existingCampaign = campaignMap.get(campaignId);
            existingCampaign.spend += metrics.cost_micros ? parseInt(metrics.cost_micros) / 1000000 : 0;
            existingCampaign.clicks += parseInt(metrics.clicks) || 0;
            existingCampaign.impressions += parseInt(metrics.impressions) || 0;
            existingCampaign.conversions += parseFloat(metrics.conversions) || 0;
            existingCampaign.ctr = parseFloat(metrics.ctr) || 0;
            existingCampaign.avgCpc = metrics.average_cpc ? parseInt(metrics.average_cpc) / 1000000 : 0;
            // Calculate derived metrics
            if (existingCampaign.clicks > 0) {
                existingCampaign.conversionRate = existingCampaign.conversions / existingCampaign.clicks * 100;
            }
            if (existingCampaign.conversions > 0) {
                existingCampaign.costPerConversion = existingCampaign.spend / existingCampaign.conversions;
            }
        });
        const campaigns = Array.from(campaignMap.values());
        // Calculate comprehensive summary
        const totalSpend = campaigns.reduce((sum, c)=>sum + c.spend, 0);
        const totalClicks = campaigns.reduce((sum, c)=>sum + c.clicks, 0);
        const totalImpressions = campaigns.reduce((sum, c)=>sum + c.impressions, 0);
        const totalConversions = campaigns.reduce((sum, c)=>sum + c.conversions, 0);
        const summary = {
            totalSpend,
            totalClicks,
            totalImpressions,
            totalConversions,
            avgCpc: totalClicks > 0 ? totalSpend / totalClicks : 0,
            avgCtr: totalImpressions > 0 ? totalClicks / totalImpressions * 100 : 0,
            conversionRate: totalClicks > 0 ? totalConversions / totalClicks * 100 : 0,
            impressionShare: campaigns.length > 0 ? campaigns.reduce((sum, c)=>sum + c.impressionShare, 0) / campaigns.length : 0,
            qualityScore: campaigns.length > 0 ? campaigns.reduce((sum, c)=>sum + c.qualityScore, 0) / campaigns.length : 0,
            campaignTypes: campaigns.reduce((acc, c)=>{
                acc[c.type] = (acc[c.type] || 0) + 1;
                return acc;
            }, {}),
            statusBreakdown: {
                enabled: campaigns.filter((c)=>c.status === 'ENABLED').length,
                paused: campaigns.filter((c)=>c.status === 'PAUSED').length,
                removed: campaigns.filter((c)=>c.status === 'REMOVED').length
            },
            performanceTrends: {
                impressions: {
                    current: totalImpressions,
                    previous: totalImpressions * 0.85,
                    change: 15
                },
                clicks: {
                    current: totalClicks,
                    previous: totalClicks * 0.92,
                    change: 8
                },
                cost: {
                    current: totalSpend,
                    previous: totalSpend * 1.05,
                    change: -5
                },
                conversions: {
                    current: totalConversions,
                    previous: totalConversions * 0.88,
                    change: 12
                }
            },
            topPerformingCampaigns: campaigns.sort((a, b)=>b.conversionRate - a.conversionRate).slice(0, 3),
            recommendations: [
                {
                    type: 'budget',
                    title: 'Optimize Budget Allocation',
                    description: 'Consider reallocating budget to top-performing campaigns.',
                    impact: 'high'
                }
            ]
        };
        return {
            success: true,
            data: {
                campaigns,
                summary
            },
            note: `Found ${campaigns.length} campaigns from Google Ads API`
        };
    } catch (error) {
        console.error('‚ùå Google Ads API error:', error);
        return {
            success: false,
            error: error.message || 'Google Ads API failed'
        };
    }
}
// Helper function with parameters
async function fetchGoogleAdsDataWithParams(loginCustomerId, startDate, endDate, dataType) {
    // For now, use the same function but could be enhanced with parameters
    return fetchGoogleAdsData();
}
}}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__4e7850be._.js.map